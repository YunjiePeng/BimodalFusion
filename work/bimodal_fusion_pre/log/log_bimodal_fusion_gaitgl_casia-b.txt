INFO:root:{'WORK_PATH': './work/bimodal_fusion', 'CUDA_VISIBLE_DEVICES': '4,5,6,7', 'dataset': 'CASIA-B', 'model': {'pretrain_pgg': 'pretrain_pgg/pgg_casia-b_gait-temporal_CASIA-B_HRNET_73_False_body_12_gait_temporal_3_64_full_128_30_0.2-100000-encoder.ptm', 'pretrain_cnn': 'pretrain_cnn/gaitgl_casia-b_CASIA-B_73_False_128_128_full_128_30_0.2-80000-encoder.ptm', 'cnn_branch': 'gaitgl', 'cnn_cfg': {'hidden_dim': 128, 'out_channels': 128}, 'pgcn_cfg': {'in_channels': 3, 'graph_cfg': {'layout': 'body_12', 'strategy': 'gait_temporal'}, 'edge_importance_weighting': True, 'out_channels': 64, 'num_id': 74}, 'fuse_cfg': {'out_channels': 128}, 'lr': 0.1, 'margin': 0.2, 'frame_num': {'silhouette': 30, 'skeleton': 30}, 'frame_num_min': {'silhouette': 15, 'skeleton': 30}, 'num_workers': 24, 'restore_iter': 0, 'hard_or_full_trip': 'full', 'batch_size': (8, 16), 'step_iter': 2000, 'total_iter': 10000, 'model_name': 'bimodal_fusion_gaitgl_casia-b'}, 'data': {'data_type': 'all', 'CASIA-B': {'resolution': '64', 'pid_num': 73, 'pid_shuffle': False, 'data_path': ['/home/pengyunjie/data/casia-b/silhouettes64/', '/home/pengyunjie/data/casia-b/hrnet/pyramid_keypoints']}, 'OUMVLP': {'resolution': '64', 'pid_num': 5153, 'pid_shuffle': False, 'data_path': ['/data_1/pengyunjie/dataset/ou-mvlp/silhouettes/', '/data_1/pengyunjie/dataset/ou-mvlp/pose/pyramid_alpha_pose_npy']}, 'FVG': {'resolution': '64', 'pid_num': 126, 'pid_shuffle': False, 'data_path': ['/data_1/pengyunjie/dataset/fvg/fvg_new/silhouettes64/', '/home/pengyunjie/data/fvg/hrnet/pyramid_keypoints']}}}
INFO:root:Initialzing...
INFO:root:Initializing data source...
INFO:root:dataset:CASIA-B, data_type:all, data_path:['/home/pengyunjie/data/casia-b/silhouettes64/', '/home/pengyunjie/data/casia-b/hrnet/pyramid_keypoints'], cache:False
INFO:root:pid_train:['001', '002', '003', '004', '006', '007', '008', '009', '010', '011', '012', '013', '014', '015', '016', '017', '018', '019', '020', '021', '022', '023', '024', '025', '026', '027', '028', '029', '030', '031', '032', '033', '034', '035', '036', '037', '038', '039', '040', '041', '042', '043', '044', '045', '046', '047', '048', '049', '050', '051', '052', '053', '054', '055', '056', '057', '058', '059', '060', '061', '062', '063', '064', '065', '066', '067', '068', '069', '070', '071', '072', '073', '074']
pid_test:['075', '076', '077', '078', '079', '080', '081', '082', '083', '084', '085', '086', '087', '088', '089', '090', '091', '092', '093', '094', '095', '096', '097', '098', '099', '100', '101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '111', '112', '113', '114', '115', '116', '117', '118', '119', '120', '121', '122', '123', '124']
INFO:root:len(pid_train):73, len(pid_test):50
INFO:root:Data initialization complete.
INFO:root:Initializing model...
INFO:root:Model initialization complete.
INFO:root:Training START
Traceback (most recent call last):
  File "train.py", line 37, in <module>
    m.fit()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 434, in fit
    self.load_pretrain()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 725, in load_pretrain
    self.gcn_encoder.module.load_state_dict(torch.load(osp.join('checkpoint', self.pretrain_pgg)))
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1045, in load_state_dict
    self.__class__.__name__, "\n\t".join(error_msgs)))
RuntimeError: Error(s) in loading state_dict for MSGG:
	size mismatch for encoder_cls.weight: copying a param with shape torch.Size([73, 64]) from checkpoint, the shape in current model is torch.Size([74, 64]).
Traceback (most recent call last):
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/distributed/launch.py", line 261, in <module>
    main()
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/distributed/launch.py", line 257, in main
    cmd=cmd)
subprocess.CalledProcessError: Command '['/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/bin/python', '-u', 'train.py', '--local_rank=3', '--model=fuse']' returned non-zero exit status 1.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
Traceback (most recent call last):
  File "train.py", line 37, in <module>
    m.fit()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 434, in fit
    self.load_pretrain()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 725, in load_pretrain
    self.gcn_encoder.module.load_state_dict(torch.load(osp.join('checkpoint', self.pretrain_pgg)))
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1045, in load_state_dict
    self.__class__.__name__, "\n\t".join(error_msgs)))
RuntimeError: Error(s) in loading state_dict for MSGG:
	size mismatch for encoder_cls.weight: copying a param with shape torch.Size([73, 64]) from checkpoint, the shape in current model is torch.Size([74, 64]).
Traceback (most recent call last):
  File "train.py", line 37, in <module>
    m.fit()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 434, in fit
    self.load_pretrain()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 725, in load_pretrain
    self.gcn_encoder.module.load_state_dict(torch.load(osp.join('checkpoint', self.pretrain_pgg)))
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1045, in load_state_dict
    self.__class__.__name__, "\n\t".join(error_msgs)))
RuntimeError: Error(s) in loading state_dict for MSGG:
	size mismatch for encoder_cls.weight: copying a param with shape torch.Size([73, 64]) from checkpoint, the shape in current model is torch.Size([74, 64]).
Traceback (most recent call last):
  File "train.py", line 37, in <module>
    m.fit()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 434, in fit
    self.load_pretrain()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 725, in load_pretrain
    self.gcn_encoder.module.load_state_dict(torch.load(osp.join('checkpoint', self.pretrain_pgg)))
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1045, in load_state_dict
    self.__class__.__name__, "\n\t".join(error_msgs)))
RuntimeError: Error(s) in loading state_dict for MSGG:
	size mismatch for encoder_cls.weight: copying a param with shape torch.Size([73, 64]) from checkpoint, the shape in current model is torch.Size([74, 64]).
