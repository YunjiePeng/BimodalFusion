INFO:root:{'WORK_PATH': './work/bimodal_fusion', 'CUDA_VISIBLE_DEVICES': '0,1,2,3,4,5,6,7', 'dataset': 'OUMVLP', 'model': {'pretrain_pgg': 'pretrain_pgg/pgg_oumvlp_gait-temporal_OUMVLP_ALPHAPOSE_5153_False_body_12_gait_temporal_3_128_full_512_18_0.2-300000-encoder.ptm', 'pretrain_cnn': 'pretrain_cnn/gaitgl_oumvlp_OUMVLP_5153_False_256_256_full_256_30_0.2-210000-encoder.ptm', 'cnn_branch': 'gaitgl', 'cnn_cfg': {'hidden_dim': 256, 'out_channels': 256}, 'pgcn_cfg': {'in_channels': 3, 'graph_cfg': {'layout': 'body_12', 'strategy': 'gait_temporal'}, 'edge_importance_weighting': True, 'out_channels': 128, 'num_id': 5153}, 'fuse_cfg': {'out_channels': 256}, 'lr': 0.1, 'margin': 0.2, 'frame_num': {'silhouette': 30, 'skeleton': 18}, 'frame_num_min': {'silhouette': 15, 'skeleton': 18}, 'num_workers': 24, 'restore_iter': 0, 'hard_or_full_trip': 'full', 'batch_size': (8, 2), 'step_iter': 4000, 'total_iter': 20000, 'model_name': 'bimodal_fusion_gaitgl_oumvlp'}, 'data': {'data_type': 'all', 'CASIA-B': {'resolution': '64', 'pid_num': 73, 'pid_shuffle': False, 'data_path': ['/home/pengyunjie/data/casia-b/silhouettes64/', '/home/pengyunjie/data/casia-b/hrnet/pyramid_keypoints']}, 'OUMVLP': {'resolution': '64', 'pid_num': 5153, 'pid_shuffle': False, 'data_path': ['/data_1/pengyunjie/dataset/ou-mvlp/silhouettes/', '/data_1/pengyunjie/dataset/ou-mvlp/pose/pyramid_alpha_pose_npy']}}}
INFO:root:Initialzing...
INFO:root:Initializing data source...
INFO:root:dataset:OUMVLP, data_type:all, data_path:['/data_1/pengyunjie/dataset/ou-mvlp/silhouettes/', '/data_1/pengyunjie/dataset/ou-mvlp/pose/pyramid_alpha_pose_npy'], cache:False
INFO:root:pid_train:['00001', '00003', '00005', '00007', '00009', '00011', '00013', '00015', '00017', '00019', '00021', '00023', '00025', '00027', '00029', '00031', '00033', '00035', '00037', '00039', '00041', '00043', '00045', '00047', '00049', '00051', '00053', '00055', '00057', '00059', '00061', '00063', '00065', '00067', '00069', '00071', '00073', '00075', '00077', '00079', '00081', '00083', '00085', '00087', '00089', '00091', '00093', '00095', '00097', '00099']
pid_test:['00001', '00003', '00005', '00007', '00009', '00011', '00013', '00015', '00017', '00019', '00021', '00023', '00025', '00027', '00029', '00031', '00033', '00035', '00037', '00039']
INFO:root:len(pid_train):50, len(pid_test):20
INFO:root:Data initialization complete.
INFO:root:Initializing model...
INFO:root:Model initialization complete.
INFO:root:Training START
Traceback (most recent call last):
  File "train.py", line 37, in <module>
    m.fit()
  File "/home/pengyunjie/tcsvt2021_bimodalFusion/model/model.py", line 557, in fit
    loss.backward()
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/tensor.py", line 185, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/autograd/__init__.py", line 127, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 324.00 MiB (GPU 0; 11.78 GiB total capacity; 1.11 GiB already allocated; 64.38 MiB free; 1.18 GiB reserved in total by PyTorch)
Exception raised from malloc at /opt/conda/conda-bld/pytorch_1595629427286/work/c10/cuda/CUDACachingAllocator.cpp:272 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x4d (0x7f042f82a77d in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x20626 (0x7f042fa82626 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x214f4 (0x7f042fa834f4 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x21b81 (0x7f042fa83b81 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #4: THCStorage_resizeBytes(THCState*, c10::StorageImpl*, long) + 0x84 (0x7f0430a3a454 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0xcfe6a8 (0x7f043098e6a8 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: at::native::(anonymous namespace)::resize_cuda_(at::Tensor&, c10::ArrayRef<long>, c10::optional<c10::MemoryFormat>) + 0x293 (0x7f043204f7f3 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x23bfdc3 (0x7f043204fdc3 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #8: at::Tensor::resize_(c10::ArrayRef<long>, c10::optional<c10::MemoryFormat>) const + 0x11f (0x7f0466ff533f in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #9: at::native::bmm_out_cuda(at::Tensor&, at::Tensor const&, at::Tensor const&) + 0x65 (0x7f0431cd0505 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #10: at::native::bmm_cuda(at::Tensor const&, at::Tensor const&) + 0x60 (0x7f0431cd0580 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0xd00e50 (0x7f0430990e50 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #12: <unknown function> + 0x7b1990 (0x7f0466736990 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #13: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f0466f1ec7c in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: at::bmm(at::Tensor const&, at::Tensor const&) + 0x4b (0x7f0466e6f44b in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x2ba2da8 (0x7f0468b27da8 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x7b1990 (0x7f0466736990 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: at::Tensor c10::Dispatcher::call<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, at::Tensor const&)> const&, at::Tensor const&, at::Tensor const&) const + 0xbc (0x7f0466f1ec7c in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: at::Tensor::bmm(at::Tensor const&) const + 0x4b (0x7f0467004a4b in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::autograd::generated::BmmBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x23a (0x7f04689fb8da in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0x30d1017 (0x7f0469056017 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #21: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&) + 0x1400 (0x7f0469051860 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&) + 0x451 (0x7f0469052401 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x89 (0x7f046904a579 in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #24: torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool) + 0x4a (0x7f046d37913a in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #25: <unknown function> + 0xc819d (0x7f046feab19d in /home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/lib/../../../../libstdc++.so.6)
frame #26: <unknown function> + 0x76ba (0x7f048a9a56ba in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #27: clone + 0x6d (0x7f048a6db41d in /lib/x86_64-linux-gnu/libc.so.6)

Traceback (most recent call last):
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/distributed/launch.py", line 261, in <module>
    main()
  File "/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/lib/python3.6/site-packages/torch/distributed/launch.py", line 257, in main
    cmd=cmd)
subprocess.CalledProcessError: Command '['/home/pengyunjie/anaconda3/envs/pytorch1.6_python3.6_cuda10.2_env/bin/python', '-u', 'train.py', '--local_rank=7', '--model=fuse']' returned non-zero exit status 1.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
